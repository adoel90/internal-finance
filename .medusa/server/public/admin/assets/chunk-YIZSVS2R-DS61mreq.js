import{cb as x,cc as g,r as c,cd as q,k as E}from"./index-VAZsH0bI.js";var S=()=>{const[r,s]=c.useState(""),[n,t]=c.useState(""),a=c.useCallback(q(i=>t(i),300),[]);return c.useEffect(()=>(a(r),()=>a.cancel()),[r,a]),{searchValue:r,onSearchValueChange:s,query:n||void 0}},I=({queryKey:r,queryFn:s,getOptions:n,defaultValue:t,defaultValueKey:a,pageSize:i=10,enabled:u=!0})=>{const{searchValue:d,onSearchValueChange:p,query:h}=S(),v=a||"id",{data:m}=x({queryKey:r,queryFn:async()=>s({[v]:t,limit:Array.isArray(t)?t.length:1}),enabled:!!t&&u}),{data:f,...y}=g({queryKey:[...r,h],queryFn:async({pageParam:e=0})=>await s({q:h,limit:i,offset:e}),initialPageParam:0,getNextPageParam:e=>e.count>e.offset+e.limit?e.offset+e.limit:void 0,placeholderData:E,enabled:u}),o=(f==null?void 0:f.pages.flatMap(e=>n(e)))??[],l=m?n(m):[],D=!y.isPending&&!o.length&&!d||!u;return t&&l.length&&!d&&l.forEach(e=>{o.find(b=>b.value===e.value)||o.unshift(e)}),{options:o,searchValue:d,onSearchValueChange:p,disabled:D,...y}};export{S as a,I as u};
